@page
@using SarasBlogg.Extensions
@model SarasBlogg.Pages.ContactModel
@{
}

<div class="card card-extra-padding container-site">
	<img class="card-img-top mb-3 rounded-2 mt-3" src="~/img/logo/kontaktaossny.png" alt="kontaktaoss logotype" />

	<h2 class="contact-title">Kontakta mig</h2>

	<form class="contact-form p-1 p-4 border rounded shadow-sm" method="post">
		<div class="mb-3">
			<label asp-for="ContactMe.Name" class="control-label contact-content"></label>
			<input asp-for="ContactMe.Name" class="form-control" />
			<span asp-validation-for="ContactMe.Name" class="text-danger"></span>
		</div>
		<div class="mb-3">
			<label asp-for="ContactMe.Email" class="control-label contact-content"></label>
			<input asp-for="ContactMe.Email" class="form-control" />
			<span asp-validation-for="ContactMe.Email" class="text-danger"></span>
		</div>
		<div class="mb-3">
			<label asp-for="ContactMe.Subject" class="control-label contact-content"></label>
			<input asp-for="ContactMe.Subject" class="form-control" />
			<span asp-validation-for="ContactMe.Subject" class="text-danger"></span>
		</div>
		<div class="mb-3">
			<label asp-for="ContactMe.Message" class="control-label contact-content"></label>
			<textarea asp-for="ContactMe.Message" class="form-control"></textarea>
			<span asp-validation-for="ContactMe.Message" class="text-danger"></span>
		</div>
		<br />
		<button type="submit" class="btn blog-btn">Skicka</button>
	</form>
</div>

	@if (TempData["addMessage"] != null)
	{
			<br />

		<div class="alert alert-success">@TempData["addMessage"]</div>
	}
	@if (TempData["deleteMessage"] != null)
	{
		<br />

		<div class="alert alert-danger">@TempData["deleteMessage"]</div>
	}

@if (User.IsInRole("admin") || User.IsInRole("superadmin"))
{
	<ul class="list-group mt-3">
		@foreach (var item in Model.ContactMes)
		{
			<li class="list-group-item d-flex align-items-start justify-content-between">
				<div class="me-2">
					<strong>@item.Name</strong>
					<div>
						<em>
							@item.Subject – @item.Message –
							<a href="mailto:@item.Email">@item.Email</a>
						</em>
					</div>
				</div>

				@* Delete får bara synas för superadmin *@
				@if (User.IsInRole("superadmin"))
				{
					<form method="post" class="ms-2" aria-label="Ta bort meddelande">
						<input type="hidden" name="deleteId" value="@item.Id" />
						<button type="submit"
								class="btn btn-close"
								title="Ta bort"
								aria-label="Ta bort"
								onclick="return confirm('Ta bort detta meddelande?');"></button>
					</form>
				}
			</li>
		}
	</ul>
}